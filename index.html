<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Sauerbraten95">
    <title>Anno 1800 Calculator</title>


    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css" />

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <!-- Popper JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="bootstrap-notify.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.4.2/knockout-min.js"></script>

    <script type="text/javascript" src="AnnoCalculator.js"></script>
    <script type="text/javascript" src="params_2020-05-30_full.js"></script>
    <script type="text/javascript" src="toggle-dark-mode.js"></script>
</head>
<body>
    <!-- #params-dialog -->
    <div id="params-dialog" class="modal fade" role="dialog" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4>Enter parameters</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>

                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <textarea class="form-control" rows="5" id="input-params"></textarea>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">OK</button>
                </div>
            </div>
        </div>
    </div>
    <!-- /#params-dialog -->
    <!-- #settings-dialog -->
    <div id="settings-dialog" class="modal fade" role="dialog" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 data-bind="text: texts.settings.name">Settings</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>

                </div>
                <div class="modal-body">
                    <form>
                        <div data-bind="foreach: settings.options">
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" class="custom-control-input" data-bind="checked: $data.checked, attr: { id: $data.id }">
                                <label class="custom-control-label" data-bind="text: $data.name, attr: { for: $data.id }"></label>
                            </div>
                        </div>
                        <hr />
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" data-bind="text: texts.language.name">Language</span>
                            </div>

                            <select name="language" class="custom-select" id="language" data-bind="value: settings.language, options:settings.languages"></select>
                        </div>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" data-bind="text: texts.islandName.name">New Island</span>
                            </div>

                            <input name="island" class="form-control" id="island" type="text" data-bind="value: $root.islandManager.islandNameInput" />
                            <div class="input-group-append">
                                <button class="btn btn-secondary" data-bind="click: () => $root.islandManager.create(), disable: $root.islandManager.islandExists">
                                    <span class="fa fa-plus"> </span>
                                </button>

                            </div>
                        </div>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" data-bind="text: texts.selectedIsland.name">Select Island</span>
                            </div>

                            <select name="islands" class="custom-select" id="islands" data-bind="value: view.island, options: view.islands, optionsText: i => i.name()"></select>
                            <div class="input-group-append">
                                <button class="btn btn-secondary" data-bind="click: () => $root.islandManager.delete(), enable: !$root.island().isAllIslands()">
                                    <span class="fa fa-trash"> </span>
                                </button>

                            </div>
                        </div>
                        <hr />
                        <h6>Server<button type="button" class="help" data-toggle="modal" data-target="#download-dialog">?</button></h6>
                        <div data-bind="foreach: settings.serverOptions">
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" class="custom-control-input" data-bind="checked: $data.checked, attr: { id: $data.id }">
                                <label class="custom-control-label" data-bind="text: $data.name, attr: { for: $data.id }"></label>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- #/settings-dialog -->
    <!-- #help-dialog -->
    <div id="help-dialog" class="modal fade" role="dialog" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 data-bind="text: texts.help.name">Settings</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>

                </div>
                <div class="modal-body">
                    <a  href="https://www.youtube.com/watch?v=fxzYSh-92Ng" target="_blank">
                        <img class="img-thumbnail img-responsive" src="CalculatorScreenshot.jpg" />
                    </a>
                    <br />
                    <span data-bind="text: texts.helpContent.name" style="white-space:pre-wrap"></span>

                </div>
            </div>
        </div>
    </div>
    <!-- /#help-dialog -->
    <!-- #factory-choose-dialog -->
    <div id="factory-choose-dialog" class="modal fade" role="dialog" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 data-bind="text: $root.texts.chooseFactories.name">Choose Factory for each Product</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>

                </div>
                <div class="modal-body">
                    <form>
                        <div data-bind="foreach: $root.island().multiFactoryProducts">


                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">
                                        <img src="" width="25" height="25" data-bind="attr: { src: $data.icon ? icon : null, alt: name }">
                                    </span>
                                    <span class="input-group-text" data-bind="text: name"></span>
                                </div>

                                <select class="custom-select" data-bind="value: $data.fixedFactory, options: $data.factories, optionsText: f => f.getRegionExtendedName(), optionsCaption: $root.texts.noFixedFactory.name()"></select>
                            </div>
                        </div>
                        <hr />

                        <div data-bind="foreach: $root.island().items">
                            <div class="ui-fchain-item" style="display: flex; flex-direction: column; justify-content:space-between; height: 12rem">

                                <div class="ui-fchain-item-name" style="height: unset">
                                    <div class="float-right">
                                        <input type="checkbox" data-bind="checked: $data.checked">
                                    </div>
                                    <span data-bind="text: name"></span>
                                </div>

                                <div class="ui-fchain-item-icon" data-bind="foreach: $data.factories"><img src="" data-bind="attr: { src: $data.icon ? icon : null, alt: name }"></div>


                                <div data-bind="foreach: $data.replacementArray">
                                    <div class="ui-fchain-item-icon-replacement">
                                        <span class="strike-through">
                                            <img src="" data-bind="attr: { src: $data.old.icon ? $data.old.icon : null, alt: $data.old.name }" width="30" height="30">
                                        </span>
                                        <div class="ui-replacement-spacer">
                                            →
                                        </div>
                                        <img src="" data-bind="attr: { src: $data.new.icon ? $data.new.icon : null, alt: $data.new.name }" width="30" height="30">
                                    </div>
                                </div>
                            </div>

                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!-- #/factory-choose-dialog -->
    <!-- #download-dialog -->
    <div id="download-dialog" class="modal fade" role="dialog" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 data-bind="text: texts.download.name">Downloads</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>

                </div>
                <div class="modal-body">
                    <table class="table">
                        <tr>
                            <td data-bind="text: texts.downloadConfig.name"></td>
                            <td>
                                <div class="btn-group float-right">
                                    <label class="btn btn-secondary" id="import-config-button" role="button" href="#" for="config-selector">
                                        <input id="config-selector" type="file" style="display: none;">
                                        <span class="fa fa-upload"> </span>
                                    </label>
                                    <label data-bind="click: () => exportConfig()" id="export-config-button" role="button" href="#" class="btn btn-secondary">
                                        <span class="fa fa-download"> </span>
                                    </label>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td data-bind="text: texts.downloadCalculator.name" style="white-space:pre-wrap"></td>
                            <td>
                                <a id="download-calculator-button" role="button" href="https://github.com/NiHoel/Anno1800Calculator/releases/latest" class="btn btn-secondary float-right">
                                    <span class="fa fa-download"> </span>
                                </a>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <span data-bind="text: texts.downloadCalculatorServer.name" style="white-space:pre-wrap"></span>
                                <a href="https://github.com/NiHoel/Anno1800UXEnhancer">https://github.com/NiHoel/Anno1800UXEnhancer</a>
                            </td>
                            <td>
                                <a id="download-calculator-server-button" role="button" href="https://github.com/NiHoel/Anno1800UXEnhancer/releases/latest" class="btn btn-secondary float-right">
                                    <span class="fa fa-download"> </span>
                                </a>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <!-- /#download-dialog -->
    <!-- top right buttons -->
    <div id="content" data-bind="visible: true" style="display:none">

        <div class="fixed-top" style="padding-right: 17px;">
            <div class="btn-group float-right">
                <button onclick="toggleDarkMode()" class="btn btn-secondary">
                    <span class="fa fa-adjust"> </span>
                </button>
                <button data-toggle="modal" data-target="#settings-dialog" class="btn btn-secondary">
                    <span class="fa fa-cog"> </span>
                </button>
                <button data-toggle="modal" data-target="#factory-choose-dialog" class="btn btn-secondary">
                    <span class="fa fa-cogs"> </span>
                </button>
                <button data-toggle="modal" data-target="#help-dialog" class="btn btn-secondary">
                    <span class="fa fa-question-circle-o"> </span>
                </button>
                <button id="download-selection-button" data-toggle="modal" data-target="#download-dialog" class="btn btn-secondary">
                    <span class="fa fa-download"> </span>
                </button>
            </div>
        </div>
        <!-- /top right buttons-->

        <div data-bind="with: $root.island()">
            <!-- population input field -->
            <fieldset class="ui-fieldset" id="residents-view">
                <legend data-bind="text:$root.texts.residents.name">Residents</legend>

                <div style="display:flex;align-items:center;justify-content:space-between;">

                    <div class="ui-race-input fleft">
                        <!-- <div class="ui-race-icon">
                            <img src="/img/icons/gui_icon_map_0-17-10.png" alt="Old World" width="46" height="46">
                        </div> -->
                        <div data-bind="foreach: $data.populationLevels">
                            <div class="ui-race-unit">
                                <div class="ui-race-unit-icon">
                                    <img src="" data-bind="attr: { src: $data.icon ? icon : null, alt: name }">
                                    <img src="icon_residence.png" class="subscript-icon" data-bind="visible: !$root.settings.existingBuildingsInput.checked()">
                                    <img src="icon_house.png" class="subscript-icon" data-bind="visible: $root.settings.existingBuildingsInput.checked()" style="margin-bottom: -5px;">
                                </div>
                                <div class="ui-race-unit-name" data-bind="text: name, visible: !$root.settings.hideNames.checked(), attr: {'race-unit-guid' : guid}"></div>

                                <div class="input text">
                                    <div class="input-group spinner mb-3">
                                        <div data-bind="if: !$root.settings.existingBuildingsInput.checked()">
                                            <input step="100" class="form-control input-lg" type="number" value="0" data-bind="value: amount, attr: {title: 'Press '+name()[0]+' to focus' };" />
                                        </div>
                                        <div data-bind="if: $root.settings.existingBuildingsInput.checked()">
                                            <input step="10" class="form-control input-lg" type="number" value="0" data-bind="value: existingBuildings, attr: {title: 'Press '+name()[0]+' to focus' };" />
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                    <btn class="btn btn-light float-right align-middle" data-bind="click: () => $root.island().reset()">Reset</btn>
                </div>
            </fieldset>
            <!-- /population input field -->
            <!-- required workforce field -->
            <fieldset class="ui-fieldset" id="workforce-view">
                <legend class="collapser" data-toggle="collapse" data-target="#workforce">
                    <span class="fa fa-chevron-right"></span>
                    <span class="fa fa-chevron-down"></span>
                    <span data-bind="text:$root.texts.workforce.name"></span>
                </legend>

                <div id="workforce" class="collapse show">

                    <div class="ui-race-input fleft">
                        <!-- <div class="ui-race-icon">
                            <img src="/img/icons/gui_icon_map_0-17-10.png" alt="Old World" width="46" height="46">
                        </div> -->
                        <div data-bind="foreach: $data.workforce">
                            <div class="ui-race-unit">
                                <div class="ui-race-unit-icon"><img data-bind="attr: { src: $data.icon ? icon : null, alt: name }"></div>
                                <!--<div class="ui-race-unit-name" data-bind="text: name"></div>-->
                                <div class="ui-fchain-item-count">
                                    <span data-bind="text: amount"></span>
                                </div>
                            </div>
                        </div>
                    </div>



                    <div class="clear"></div>
                </div>
            </fieldset>
            <!-- /required workforce field -->
            <!-- required factories by category -->
            <div data-bind="foreach: $data.categories">
                <fieldset class="ui-fieldset" id="categories-view">
                    <legend class="collapser" data-toggle="collapse" data-bind="attr: {'data-target' : '#' + removeSpaces(name)}">
                        <span class="fa fa-chevron-right"></span>
                        <span class="fa fa-chevron-down"></span>
                        <span data-bind="text:name"></span>
                    </legend>

                    <div class="ui-fchain collapse show" data-bind="attr: {id:  removeSpaces(name)}">
                        <div data-bind="foreach: $data.products">
                            <div data-bind="foreach: $data.factories">
                                <div>

                                    <div class="ui-fchain-item" data-bind="visible: amount() > 0 || existingBuildings() > 0 || $data.editable && (!$root.settings.hideNewWorldConstructionMaterial.checked() || $data.region.guid === 5000000), css: $root.settings.missingBuildingsHighlight.checked() && buildings() > existingBuildings() ? 'danger' : ''">
                                        <div class="ui-fchain-item-name" data-bind="text: $data.getRegionExtendedName(), visible: !$root.settings.hideNames.checked()"></div>
                                        <div class="ui-fchain-item-icon"><img src="" data-bind="attr: { src: $data.icon ? icon : null, alt: name }"></div>
                                        <div class="ui-fchain-item-count">
                                            <div href="#" data-toggle="tooltip" data-bind="attr: {'title' : $root.texts.productionBoost.name}, visible: !$root.settings.hideProductionBoost.checked()">
                                                <div class="input-group mb-3 spinner">
                                                    <input class="form-control" type="text" value="100" data-bind="value: percentBoost" />
                                                    <div class="input-group-append">
                                                        <div class="input-group-btn-vertical">
                                                            <button class="btn btn-default" type="button" data-bind="click: incrementPercentBoost"><i class="fa fa-caret-up"></i></button>
                                                            <button class="btn btn-default" type="button" data-bind="click: decrementPercentBoost, enable: parseInt(percentBoost()) > 1"><i class="fa fa-caret-down"></i></button>
                                                        </div>
                                                        <span class="input-group-text">%</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="ui-fchain-item-module" data-bind="if: !!$data.module">
                                            <div style="flex: 100 1 auto;"></div>
                                            <div class="custom-control custom-checkbox" style="flex: auto;">
                                                <input type="checkbox" class="custom-control-input" data-bind="checked: $data.moduleChecked, attr: { id: $data.guid + '-module' }">
                                                <label class="custom-control-label" data-bind="attr: { for: $data.guid + '-module' }" src-only style="vertical-align: top;">

                                                </label>
                                            </div>
                                            <img src="" width="25" height="25" data-bind="attr: { src: $data.module.icon ? $data.module.icon  : null, alt: $data.module.name, for: $data.guid + '-module' }" style="flex: auto;">
                                            <div style="flex: 100 1 auto;"></div>
                                        </div>

                                        <!-- buildings display for non-construction products -->
                                        <div class="ui-fchain-item-count" data-bind="if: !$data.editable">
                                            <div href="#" data-toggle="tooltip" data-bind="attr: {'title' : $root.texts.requiredNumberOfBuildings.name}">
                                                <span data-bind="text: $root.settings.decimalsForBuildings.checked() ? Math.ceil(100*parseFloat(buildings()))/100 : Math.ceil(buildings())"></span>
                                                <span>x</span>
                                                <div class="btn-group" role="group">
                                                    <button type="button" class="btn btn-secondary" data-bind="click: () => incrementBuildings(), enable: buildings() > 0" style="padding: 0em 0.25em 0em 0.25em; font-size: unset;">+</button>
                                                    <button type="button" class="btn btn-secondary" data-bind="click: () => decrementBuildings(), enable: buildings() >= 1.01" style="padding: 0em 0.25em 0em 0.25em; font-size: unset;">-</button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- existing buildings input for non-construction products -->
                                        <div class="ui-fchain-item-count" data-bind="if: !$data.editable && $root.settings.missingBuildingsHighlight.checked()">
                                            <div href="#" data-toggle="tooltip" data-bind="attr: {'title' : $root.texts.existingNumberOfBuildings.name}">
                                                <span data-bind="text: $root.texts.existingNumberOfBuildingsIs.name"></span>
                                                <span data-bind="text: existingBuildings()"></span>
                                                <span>x</span>
                                                <div class="btn-group" role="group">
                                                    <button type="button" class="btn btn-secondary" data-bind="click: () => existingBuildings(parseInt(existingBuildings() + 1))" style="padding: 0em 0.25em 0em 0.25em; font-size: unset;">+</button>
                                                    <button type="button" class="btn btn-secondary" data-bind="click: () => existingBuildings(parseInt(existingBuildings() - 1)), enable: existingBuildings() >= 1" style="padding: 0em 0.25em 0em 0.25em; font-size: unset;">-</button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- buildings input for construction material -->
                                        <div class="ui-fchain-item-count" data-bind="if: $data.editable">
                                            <div href="#" data-toggle="tooltip" data-bind="attr: {'title' : $root.texts.requiredNumberOfBuildings.name}">

                                                <div class="input-group mb-3 spinner">
                                                    <input class="form-control" type="text" value="0" step="1" data-bind="value: existingBuildings" />
                                                    <div class="input-group-append">
                                                        <div class="input-group-btn-vertical">
                                                            <button class="btn btn-default" type="button" data-bind="click: () => existingBuildings(parseInt(existingBuildings()) + 1)"><i class="fa fa-caret-up"></i></button>
                                                            <button class="btn btn-default" type="button" data-bind="click: () => existingBuildings(parseInt(existingBuildings()) - 1), enable: existingBuildings() > 0"><i class="fa fa-caret-down"></i></button>
                                                        </div>
                                                        <span class="input-group-text">x</span>
                                                    </div>
                                                </div>

                                            </div>
                                        </div>

                                        <!-- required buildings display for construction materials -->
                                        <div class="ui-fchain-item-count" data-bind="if: $data.editable &&  buildings() > existingBuildings()">
                                            <div href="#" data-toggle="tooltip" data-bind="attr: {'title' : $root.texts.requiredNumberOfBuildingsDescription.name}">
                                                <span data-bind="text: $root.texts.requiredNumberOfBuildings.name"></span>
                                                <span data-bind="text: $root.settings.decimalsForBuildings.checked() ? Math.ceil(100*parseFloat(buildings()))/100 : Math.ceil(buildings())"></span>
                                                <span>x</span>
                                                <div class="btn-group" role="group">
                                                    <button type="button" class="btn btn-secondary" data-bind="click: () => incrementBuildings(), enable: buildings() > 0" style="padding: 0em 0.25em 0em 0.25em; font-size: unset;">+</button>
                                                    <button type="button" class="btn btn-secondary" data-bind="click: () => decrementBuildings(), enable: buildings() > 1.00001" style="padding: 0em 0.25em 0em 0.25em; font-size: unset;">-</button>
                                                </div>
                                            </div>
                                        </div>

                                        <div href="#" data-toggle="tooltip" data-bind="attr: {'title' : $root.texts.tonsPerMinute.name}">
                                            <div class="ui-fchain-item-load"><span data-bind="text: Math.ceil(100*parseFloat(amount()))/100"></span><span> t/min</span></div>

                                        </div>
                                        <div class="ui-fchain-item-load" data-bind="if: !$data.editable, visible: $root.settings.additionalProduction.checked()">

                                            <div class="input-group spinner mb-3">
                                                <div class="input-group-prepend"><span class="input-group-text">+ </span> </div>
                                                <input step="0.1" class="form-control" type="number" value="0" data-bind="value: extraAmount" />
                                            </div>

                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div data-bind="foreach: $data.consumers">

                            <div class="ui-fchain-item" data-bind="visible: !$root.settings.hideNewWorldConstructionMaterial.checked() || $data.region.guid === 5000000, css: $root.settings.missingBuildingsHighlight.checked() && buildings() > existingBuildings() ? 'danger' : ''">
                                <div class="ui-fchain-item-name" data-bind="text: $data.getRegionExtendedName(), visible: !$root.settings.hideNames.checked()"></div>
                                <div class="ui-fchain-item-icon"><img src="" data-bind="attr: { src: $data.icon, alt: name }"></div>


                                <!-- buildings input  -->
                                <div class="ui-fchain-item-count">
                                    <div href="#" data-toggle="tooltip" data-bind="attr: {'title' : $root.texts.requiredNumberOfBuildings.name}">

                                        <div class="input-group mb-3 spinner">
                                            <input class="form-control" type="text" value="0" step="1" data-bind="value: existingBuildings" />
                                            <div class="input-group-append">
                                                <div class="input-group-btn-vertical">
                                                    <button class="btn btn-default" type="button" data-bind="click: () => existingBuildings(parseInt(existingBuildings()) + 1)"><i class="fa fa-caret-up"></i></button>
                                                    <button class="btn btn-default" type="button" data-bind="click: () => existingBuildings(parseInt(existingBuildings()) - 1), enable: existingBuildings() > 0"><i class="fa fa-caret-down"></i></button>
                                                </div>
                                                <span class="input-group-text">x</span>
                                            </div>
                                        </div>

                                    </div>
                                </div>

                                <!-- required buildings display -->
                                <div class="ui-fchain-item-count" data-bind="if: buildings() > existingBuildings()">
                                    <div href="#" data-toggle="tooltip" data-bind="attr: {'title' : $root.texts.requiredNumberOfBuildingsDescription.name}">
                                        <span data-bind="text: $root.texts.requiredNumberOfBuildings.name"></span>
                                        <span data-bind="text: $root.settings.decimalsForBuildings.checked() ? Math.ceil(100*parseFloat(buildings()))/100 : Math.ceil(buildings())"></span>
                                        <span>x</span>
                                        <div class="btn-group" role="group">
                                            <button type="button" class="btn btn-secondary" data-bind="click: () => incrementBuildings(), enable: buildings() > 0" style="padding: 0em 0.25em 0em 0.25em; font-size: unset;">+</button>
                                            <button type="button" class="btn btn-secondary" data-bind="click: () => decrementBuildings(), enable: buildings() > 1.00001" style="padding: 0em 0.25em 0em 0.25em; font-size: unset;">-</button>
                                        </div>
                                    </div>
                                </div>

                                <div href="#" data-toggle="tooltip" data-bind="attr: {'title' : $root.texts.tonsPerMinute.name}">
                                    <div class="ui-fchain-item-load"><span data-bind="text: Math.ceil(100*parseFloat(amount()))/100"></span><span> t/min</span></div>

                                </div>
                            </div>



                        </div>
                    </div>
                    <div class="clear"></div>
                </fieldset>
            </div>
            <!-- /required factories by category -->
            <!-- production chains by population level -->
            <div data-bind="foreach: $data.populationLevels">
                <fieldset class="ui-fieldset" id="consumption-view" data-bind="visible: amount() || existingBuildings()">
                    <legend class="collapser" data-toggle="collapse" data-bind="attr: {'data-target' : '#consumption-' +  removeSpaces(name)}">
                        <span class="fa fa-chevron-right"></span>
                        <span class="fa fa-chevron-down"></span>
                        <span data-bind="text:name"></span>
                    </legend>
                    <div class="collapse show" data-bind="foreach: needs, attr:{id: 'consumption-' +  removeSpaces(name)}">
                        <div class="ui-fchain" data-bind="visible: optionalAmount(), css:{inactive: banned}">
                            <div class="d-flex flex-wrap align-content-start" data-bind="foreach: allDemands">
                                <div class="ui-fchain-spacer" data-bind="visible: !($data instanceof Need) && amount()">
                                    ←
                                </div>
                                <div class="ui-fchain-item" data-bind="visible: ($data instanceof Need) || amount() || ($data instanceof Need)">
                                    <div class="float-right" data-bind="if: ($data instanceof Need)">
                                        <input type="checkbox" data-bind="checked: $data.checked">
                                    </div>
                                    <div class="ui-fchain-item-name" data-bind="text: product.name, visible: !$root.settings.hideNames.checked()"></div>
                                    <div class="ui-fchain-item-icon"><img src="" data-bind="attr: { src: $data.product.icon ? product.icon : null, alt: product.name }"></div>
                                    <div class="input-group mb-3 spinner" href="#" data-toggle="tooltip" data-bind="if: $data instanceof Need, attr: {'title' : $root.texts.consumptionModifier.name}, visible: $root.settings.consumptionModifier.checked()">
                                        <input class="form-control" type="text" value="100" min="1" data-bind="value: percentBoost" />
                                        <div class="input-group-append">
                                            <div class="input-group-btn-vertical">
                                                <button class="btn btn-default" type="button" data-bind="click: incrementPercentBoost"><i class="fa fa-caret-up"></i></button>
                                                <button class="btn btn-default" type="button" data-bind="click: decrementPercentBoost, enable: parseInt(percentBoost()) > 1"><i class="fa fa-caret-down"></i></button>
                                            </div>
                                            <span class="input-group-text">%</span>
                                        </div>
                                    </div>

                                    <div class="ui-fchain-item-count">
                                        <span href="#" data-toggle="tooltip" data-bind="attr: {'title' : $root.texts.requiredNumberOfBuildings.name}">
                                            <span data-bind="text: $root.settings.decimalsForBuildings.checked() ? Math.ceil(100*parseFloat(buildings()))/100 : Math.ceil(buildings())"></span>
                                            <span>x</span>
                                        </span>
                                    </div>
                                    <div class="ui-fchain-item-load">
                                        <span href="#" data-toggle="tooltip" data-bind="attr: {'title' : $root.texts.tonsPerMinute.name}">
                                            <span data-bind="text: Math.ceil(100*parseFloat(amount()))/100"></span><span> t/min</span>
                                        </span>
                                    </div>
                                    <!--<div class="ui-fchain-item-loadbar"><div style="background-color:red; width:4px;"><img src="/img/pixel.gif" width="1" height="6"></div></div>-->
                                </div>
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                </fieldset>
            </div>
            <!-- /production chains by population level -->
            <!-- production chains for building materials -->
            <fieldset class="ui-fieldset" id="construction-material-view">
                <legend class="collapser" data-toggle="collapse" data-target="#building-materials-chains">
                    <span class="fa fa-chevron-right"></span>
                    <span class="fa fa-chevron-down"></span>
                    <span data-bind="text: $root.island().categories[1].name"></span>
                </legend>
                <div class="collapse show" data-bind="foreach: $data.buildingMaterialsNeeds" id="building-materials-chains">
                    <div class="ui-fchain" data-bind="visible: amount">
                        <div data-bind="foreach: $data.allDemands">
                            <div class="ui-fchain-spacer" data-bind="visible: !($data instanceof Need) && amount">
                                ←
                            </div>
                            <div class="ui-fchain-item" data-bind="visible: amount">
                                <div class="ui-fchain-item-name" data-bind="text: product.name, visible: !$root.settings.hideNames.checked()"></div>
                                <div class="ui-fchain-item-icon"><img src="" data-bind="attr: { src: $data.product.icon ? product.icon : null, alt: product.name }"></div>
                                <div class="ui-fchain-item-count">
                                    <span href="#" data-toggle="tooltip" data-bind="attr: {'title' : $root.texts.requiredNumberOfBuildings.name}">
                                        <span data-bind="text: $root.settings.decimalsForBuildings.checked() ? Math.ceil(100*parseFloat(buildings()))/100 : Math.ceil(buildings())"></span>
                                        <span>x</span>
                                    </span>
                                </div>
                                <div class="ui-fchain-item-load">
                                    <span href="#" data-toggle="tooltip" data-bind="attr: {'title' : $root.texts.tonsPerMinute.name}">
                                        <span data-bind="text: Math.ceil(100*parseFloat(amount()))/100"></span><span> t/min</span>
                                    </span>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div class="clear"></div>
                </div>
            </fieldset>
            <!-- /production chains for building materials -->
        </div>
    </div>
</body>
</html>
